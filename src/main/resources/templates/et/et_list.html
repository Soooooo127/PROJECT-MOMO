<!DOCTYPE html>
<html layout:decorate="~{layout}">
	<head>

		<link rel="stylesheet" type="text/css" th:href="@{/css/restEat.css}">

	<title>같이먹자</title>

	</head>
	<body>
		<div layout:fragment="content" class="container">
			<!--들어갈 내용-->
			
			
			
			
			
			
		<div class="col-6 my-3">
			<div class="input-group justify-content-end">
				<input type="text" id="search_kw" class="form-control" th:value="${kw}">
				<button class="btn btn-outline-secondary" type="button" id="btn_search">검색</button>
			</div>
		</div>
		<form th:action="@{/et/list}" method="get" id="searchForm">
			<input type="hidden" id="kw" name="kw" th:value="${kw}">
			<input type="hidden" id="page" name="page" th:value="${paging.number}">
		</form>
		
		
		<!-- 같이먹기 방 리스트-->	
		<div class="list">
			
			<div class="card border-primary mb-3   c" style="max-width: 25rem;" th:each="et : ${paging}">
				<a th:href="@{|detail/${et.rest.no}/${et.no}|}">
					<h5 class="card-header ">
						<span th:text="${et.ettitle}"></span>
								
						<span style="font-size: 13px;" th:if="${#temporals.format(et.etdate , 'yyyy-MM-dd') <= #calendars.format(#calendars.createNow() , 'yyyy-MM-dd')}">(참여기간 만료)</span>
					</h5>
												 
						<!--사진-->						 
					<img th:src="${et.rest.img}" class="img">
											
						<!--태그-->						 
												  
					<div class="card-footer text-muted " >
						<h5 th:text="${et.rest.name}"></h5>
							<span  class="tag">
								<li>
									<a th:text="|모집하는 인원수 : ${#lists.size(et.prtmember)}/${et.prtnumber}|"></a>
								</li>
																				
								<li>
									<a th:text="|신청일 : ${#temporals.format(et.regdate , 'yyyy-MM-dd HH:mm')}|"></a>
								</li>
																		
								<li>
									<a th:text="|같이먹는날 : ${#temporals.format(et.etdate , 'yyyy-MM-dd HH:mm')}|"></a>
								</li>
							</span>
					</div>
				</a>			  
			</div>

		</div>
		
	<!--페이징-->
		<div th:if="${!paging.isEmpty()}">
			<ul class="pagination justify-content-center">
				<li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
					<a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}">
						<span>prev</span>
					</a>
				</li>
								
				<li th:each="page : ${#numbers.sequence(0 , paging.totalPages -1)}"
				th:if="${page >= paging.number -5 and page <= paging.number +5}"
				th:classappend="${page == paging.number} ? 'active'" class="page-item">
					<a th:text="${page}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
				</li>
						
				<li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
					<a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}">
						<span>next</span>
					</a>
				</li>
			</ul>
		</div>

		
		
		
		<!--내용의 끝-->
		</div>
		<script layout:fragment="script" type="text/javascript">
			const page_elements = document.getElementsByClassName("page-link");
			Array.from(page_elements).forEach(function(element){
				element.addEventListener('click' , function(){
					document.getElementById('page').value = this.dataset.page;
					document.getElementById('searchForm').submit();
				});
			});
					
					
					
			const btn_search = document.getElementById("btn_search");
			btn_search.addEventListener('click' , function(){
				document.getElementById('kw').value = document.getElementById('search_kw').value;
				document.getElementById('page').value = 0;
				document.getElementById('searchForm').submit();
			});
		</script>
	</body>
</html>