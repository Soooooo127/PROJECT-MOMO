<html layout:decorate="~{layout_mypage}">
<div layout:fragment="mypageContent">
	
	<!--전체 영역-->
		<div>
			<!--콘텐츠 영역-->
			<div>	
				<!--로고 영역-->	
				<div>
					로고
				</div>
				<!--콘텐츠 세부 영역-->
					<div class="frame-dvd">
						<!--본문 전체-->
						<div>
							<h5>내 같이 먹기</h5>
							<form th:action="@{/mypage/myET}" method="get" id="searchForm">
								<input type="hidden" id="ettitle" name="ettitle" th:value="${ettitle}">
								<input type="hidden" id="page" name="page" th:value="${myET.number}">
							</form>
							<div th:each="et : ${myET}">
								<div class="card w-75 mb-3">
					                <div class="card-body">
						                <a th:href=@{|/et/detail/${et.rest.no}/${et.no}|} th:text="${et.ettitle}"></a>
						                <p class="card-text" th:text="${et.rest.name}"></p>
						                <ul>
					                      <li>
								            <a th:text="|모집하는 인원수 : ${#lists.size(et.prtmember)}/${et.prtnumber}|"></a>
							              </li>
							              <li>
								            <a th:text="|신청일 : ${#temporals.format(et.regdate , 'yyyy-MM-dd HH:mm')}|"></a>
							              </li>
							              <li>
								            <a th:text="|같이먹는날 : ${#temporals.format(et.etdate , 'yyyy-MM-dd HH:mm')}|"></a>
							              </li>		
						                 </ul>
					              </div>
			                   </div>
						</div>
						
						<!--같이먹기 검색-->
						<div class="my-3" align="right">
						   <form th:action="@{/mypage/myET}" method="get">
							 <input type="text" id="search_ettitle" th:value="${ettitle}">
							 <button type="button" id="btn_search_ettitle" class="btn btn-outline-secondary">검색</button>
						   </form>	
						</div>
						<!--같이먹기 페이징-->
						<div th:if="${!myET.isEmpty()}" >
							<ul class="pagination pagination-sm justify-content-center">
							   <li class="page-item" th:classappend="${!myET.hasPrevious} ? 'disabled'">
								  <a class="page-link" href="javascript:void(0)" th:data-page="${myET.number-1}">
									<span>이전</span>
								  </a>
							   </li>
							   <li th:each="page : ${#numbers.sequence(0, myET.totalPages-1) }"
							   th:if="${page >= myET.number -3 and page <= myET.number + 3}"
							   th:classappend="${page==myET.number} ? 'active'" class="page-item">
								  <a th:text="${page+1}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
							   </li>
							   <li class="page-item" th:classappend="${!myET.hasNext} ? 'disabled'">
								  <a class="page-link" href="javascript:void(0)" th:data-page="${myET.number+1}">
									 <span>다음</span>
								  </a>
							   </li>
							</ul>
						</div>
					</div>
				</div>
			</div>
	</div>
	
	<script layout:fragment="script" type="text/javascript">
	  	const page_elements = document.getElementsByClassName("page-link");
	  	Array.from(page_elements).forEach(function(element){
	  	  element.addEventListener('click' , function(){
	  	    document.getElementById('page').value = this.dataset.page;
	  		document.getElementById('searchForm').submit();
	  	  });
	  	});
	  	const btn_search = document.getElementById("btn_search_ettitle");
	  	btn_search.addEventListener('click' , function(){
	  	  document.getElementById('ettitle').value = document.getElementById('search_ettitle').value;
	  	  document.getElementById('page').value = 0;
	  	  document.getElementById('searchForm').submit();
	  	});
	  </script>
</div>	
</html>