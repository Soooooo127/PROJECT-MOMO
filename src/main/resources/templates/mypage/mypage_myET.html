<html layout:decorate="~{layout_mypage}">
	    <head>
			<link rel="stylesheet" type="text/css" th:href="@{/css/myEtList.css}">
			<title>맛집검색하자</title>	
		</head>
		<body>
			<div layout:fragment="mypageContent">
	
	<!--전체 영역-->
		<div>
			<!--콘텐츠 영역-->
			<div>	
				<!--로고 영역-->	
				<div>
					로고
				</div>
				<!--콘텐츠 세부 영역-->
					<div class="frame-dvd">
						<!--본문 전체-->
				       <span style="font-size: 20px; font-weight: bold;">내 같이먹기</span>
						<!--찜한 가게가 없을 때-->
						<div th:if="${myET.isEmpty()}" class="card my-4" style="height:200px; background-color: gainsboro;" >
							<strong style="margin:auto">현재 참여중인 방이 없습니다. 같이 먹기를 신청해 보세요.</strong>
						</div>
						<!--찜한 가게가 있을 때-->
						<div th:unless="${myET.isEmpty()}" class="new_list">
							<form th:action="@{/mypage/myET}" method="get" id="searchForm">
								<input type="hidden" id="ettitle" name="ettitle" th:value="${ettitle}">
								<input type="hidden" id="page" name="page" th:value="${myET.number}">
							</form>	
							<!--식당사진 리스트-->
							<div class="list mx-3">			
								<div class="card mb-2 c1"  th:each="et : ${myET}">
									<a th:href="@{|/et/detail/${et.rest.no}/${et.no}|}" class="a1">	
									<div class="c2">					 
										<img src="https://flexible.img.hani.co.kr/flexible/normal/640/427/imgdb/original/2023/0306/20230306502777.jpg" class="img">								
									</div>	
										<div class="card-body" >	
										<h5 class="card-title">
											<span th:text="${et.ettitle}"></span>	
											<span style="font-size: 13px;" th:if="${#temporals.format(et.etdate , 'yyyy-MM-dd') <= #calendars.format(#calendars.createNow() , 'yyyy-MM-dd')}">(참여기간 만료)</span>
										</h5>										 
											<span th:text="${et.rest.name}"></span><br>
											<span th:text="|모집 인원 : ${#lists.size(et.prtmember)}/${et.prtnumber}|"></span>	<br>										
											<span th:text="|신청일 : ${#temporals.format(et.regdate , 'yyyy-MM-dd HH:mm')}|"></span><br>																						
											<span th:text="|같이먹는날 : ${#temporals.format(et.etdate , 'yyyy-MM-dd HH:mm')}|"></span>			
										</div>
									</a> 
								</div>
							</div>
						</div>
						<!--같이먹기 검색-->
						<div align="right">
						   <form th:action="@{/mypage/myET}" method="get">
							 <input type="text" id="search_ettitle" th:value="${ettitle}">
							 <button type="button" id="btn_search_ettitle" class="btn btn-outline-secondary">검색</button>
						   </form>	
						</div>
						<!--같이먹기 페이징-->
						<div th:if="${!myET.isEmpty()}" >
							<ul class="pagination pagination-sm justify-content-center">
							   <li class="page-item" th:classappend="${!myET.hasPrevious} ? 'disabled'">
								  <a class="page-link" href="javascript:void(0)" th:data-page="${myET.number-1}">
									<span>이전</span>
								  </a>
							   </li>
							   <li th:each="page : ${#numbers.sequence(0, myET.totalPages-1) }"
							   th:if="${page >= myET.number -3 and page <= myET.number + 3}"
							   th:classappend="${page==myET.number} ? 'active'" class="page-item">
								  <a th:text="${page+1}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
							   </li>
							   <li class="page-item" th:classappend="${!myET.hasNext} ? 'disabled'">
								  <a class="page-link" href="javascript:void(0)" th:data-page="${myET.number+1}">
									 <span>다음</span>
								  </a>
							   </li>
							</ul>
						</div>
					</div>
				</div>
			</div>
	</div>
	
	<script layout:fragment="script" type="text/javascript">
	  	const page_elements = document.getElementsByClassName("page-link");
	  	Array.from(page_elements).forEach(function(element){
	  	  element.addEventListener('click' , function(){
	  	    document.getElementById('page').value = this.dataset.page;
	  		document.getElementById('searchForm').submit();
	  	  });
	  	});
	  	const btn_search = document.getElementById("btn_search_ettitle");
	  	btn_search.addEventListener('click' , function(){
	  	  document.getElementById('ettitle').value = document.getElementById('search_ettitle').value;
	  	  document.getElementById('page').value = 0;
	  	  document.getElementById('searchForm').submit();
	  	});
	  </script>	
</body>
</html>