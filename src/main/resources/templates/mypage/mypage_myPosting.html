<html layout:decorate="~{layout_mypage}">
<div layout:fragment="mypageContent">
		
	<style>
		th.bg{ 
			background-color: #fbe1e0;
			width:20%;
		}
		    
		.noline {
			text-decoration-line: none;
			color: black;
		}
		

	</style>
	<!--전체 영역-->
	<div>
		<!--콘텐츠 영역-->
		<div>	
			<!--로고 영역-->	
			<div>
				로고
			</div>
			<!--콘텐츠 세부 영역-->
				<div class="frame-dvd">
					<!--본문 전체-->
					<div>
						<form th:action="@{/mypage/myPosting}" method="get" id="searchForm">
							<input type="hidden" id="freeSubject" name="freeSubject" th:value="${freeSubject}">
							<input type="hidden" id="page" name="page" th:value="${myFreePosting.number}">
							<input type="hidden" id="askSubject" name="askSubject" th:value="${askSubject}">
						    <input type="hidden" id="pg" name="pg" th:value="${myAskPosting.number}">
					 	</form>
						<!--글 목록(자유게시판)-->
						 <table class="table table-hover">
							<h5>내 자유게시판</h5>
								<thead>
									<tr class="table-primary">
									  <th>제목</th>
									  <th>작성일</th>
									</tr>
								</thead>
								<tbody>
								  <div >
									<tr class="table" th:each="posting :${myFreePosting}">
										<td>
										<a class="noline" th:href="@{|/free/detail/${posting.no}|}" th:text="${posting.subject}"></a>
										</td>
										<td th:if="${#calendars.format(#calendars.createNow(), 'yyyy.MM.dd') == #temporals.format(posting.createDate, 'yyyy.MM.dd')}" 
										th:text="${#temporals.format(posting.createDate, 'HH:mm')}"></td>
										<td th:unless="${#calendars.format(#calendars.createNow(), 'yyyy.MM.dd') == #temporals.format(posting.createDate, 'yyyy.MM.dd')}" 
										th:text="${#temporals.format(posting.createDate, 'yyyy.MM.dd')}"></td>	
									</tr>
								 </div>
								</tbody>
								</table>			
							    <!--자유게시판 검색-->
								  <div class="my-3" align="right">
									 <form th:action="@{/mypage/myPosting}" method="get">
										<input type="text" id="search_freeSubject" th:value="${freeSubject}">
										<button type="button" id="btn_search_freeSubject" class="btn btn-outline-secondary">검색</button>
									 </form>	
								  </div>
								<!--자유게시판 페이징-->
								  <div th:if="${!myFreePosting.isEmpty()}" >
									<ul class="pagination pagination-sm justify-content-center">
									  <li class="page-item" th:classappend="${!myFreePosting.hasPrevious} ? 'disabled'">
										 <a name="z" class="page-link" href="javascript:void(0)" th:data-page="${myFreePosting.number-1}">
											<span>이전</span>
										 </a>
									  </li>
									  <li th:each="page : ${#numbers.sequence(0, myFreePosting.totalPages-1) }"
							           th:if="${page >= myFreePosting.number -3 and page <= myFreePosting.number + 3}"
									   th:classappend="${page==myFreePosting.number} ? 'active'" class="page-item">
									     <a name="z" th:text="${page+1}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
									  </li>
									  <li class="page-item" th:classappend="${!myFreePosting.hasNext} ? 'disabled'">
										  <a name="z" class="page-link" href="javascript:void(0)" th:data-page="${myFreePosting.number+1}">
											  <span>다음</span>
										  </a>
									  </li>
								    </ul>
								 </div>
								 <hr>
				    <!--글 목록(질문%답변)-->
					<table class="table table-hover">
						<h5>내 질문&답변</h5>
						<thead>
							<tr class="table-primary">
								<th>제목</th>
								<th>작성일</th>
							</tr>
						</thead>
						<tbody>
							<div>
							   <tr class="table" th:each="posting :${myAskPosting}">
									<td>
								    <a class="noline" th:href="@{|/askPosting/detail/${posting.no}|}" th:text="${posting.subject}"></a>
									</td>
								    <td th:if="${#calendars.format(#calendars.createNow(), 'yyyy.MM.dd') == #temporals.format(posting.createDate, 'yyyy.MM.dd')}" 
								     th:text="${#temporals.format(posting.createDate, 'HH:mm')}"></td>
									<td th:unless="${#calendars.format(#calendars.createNow(), 'yyyy.MM.dd') == #temporals.format(posting.createDate, 'yyyy.MM.dd')}" 
								     th:text="${#temporals.format(posting.createDate, 'yyyy.MM.dd')}"></td>	
								</tr>
							</div>
						</tbody>
					</table>			
					<!--질문%답변 검색-->
					<div class="my-3" align="right">
						<form th:action="@{/mypage/myPosting}" method="get">
							<input type="text" id="search_askSubject" th:value="${askSubject}">
							<button type="button" id="btn_search_askSubject" class="btn btn-outline-secondary">검색</button>
						</form>	
					</div>
					<!--질문%답변  페이징-->
					 <div th:if="${!myAskPosting.isEmpty()}">
						<ul class="pagination pagination-sm justify-content-center">
							<li class="page-item" th:classappend="${!myAskPosting.hasPrevious} ? 'disabled'">
						      <a name="y"  class="page-link" href="javascript:void(0)" th:data-page="${myAskPosting.number-1}">
								 <span>이전</span>
							  </a>
							</li>
							<li th:each="pg : ${#numbers.sequence(0, myAskPosting.totalPages-1) }"
							   th:if="${pg >= myAskPosting.number -3 and pg <= myAskPosting.number + 3}"
							   th:classappend="${pg==myAskPosting.number} ? 'active'" class="page-item">
							   <a name="y" th:text="${pg+1}" class="page-link" href="javascript:void(0)" th:data-page="${pg}"></a>
							</li>
							<li class="page-item" th:classappend="${!myAskPosting.hasNext} ? 'disabled'">
							   <a name="y"  class="page-link" href="javascript:void(0)" th:data-page="${myAskPosting.number+1}">
								 <span>다음</span>
							   </a>
							</li>
						</ul>
					  </div>	     					
					  </div>
					 </div>
				  </div>
			    </div> 
		    
	  <script layout:fragment="script" type="text/javascript">
	  	const page_elements = document.getElementsByName("y");
	  	Array.from(page_elements).forEach(function(element){
	  	  element.addEventListener('click' , function(){
	  	    document.getElementById('pg').value = this.dataset.page;
	  		document.getElementById('searchForm').submit();
	  	  });
	  	});
	  	const btn_search = document.getElementById("btn_search_askSubject");
	  	btn_search.addEventListener('click' , function(){
	  	  document.getElementById('askSubject').value = document.getElementById('search_askSubject').value;
	  	  document.getElementById('pg').value = 0;
	  	  document.getElementById('searchForm').submit();
	  	});
	  </script>
	  <script layout:fragment="script" type="text/javascript">
	  	  	const page_element = document.getElementsByName("z");
	  	  	Array.from(page_element).forEach(function(element){
	  	  	  element.addEventListener('click' , function(){
	  	  	    document.getElementById('page').value = this.dataset.page;
	  	  		document.getElementById('searchForm').submit();
	  	  	  });
	  	  	});
	  	  	const btn_searchs = document.getElementById("btn_search_freeSubject");
	  	  	btn_searchs.addEventListener('click' , function(){
	  	  	  document.getElementById('freeSubject').value = document.getElementById('search_freeSubject').value;
	  	  	  document.getElementById('page').value = 0;
	  	  	  document.getElementById('searchForm').submit();
	  	  	});
	  	  </script> 
</div>	
</html>