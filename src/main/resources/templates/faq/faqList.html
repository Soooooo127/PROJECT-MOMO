<!DOCTYPE html>
<html layout:decorate="~{layout}">	
	<head>
		<style>
			a.faq {
				text-decoration: none;
				font-size: 30px;
			}
			a.s{
				text-decoration: none;			
			}
			
		</style>
	<title>자주 묻는 질문</title>
	</head>
	<body>
	<div layout:fragment="content" class="container ">

	<div>
	<a class="faq" th:href="@{/faq/list}">FAQ</a>
	<hr>
	
	
	<!--카테고리 넣기-->	
		<div class="d-grid gap-2 d-md-block mb-3">
			<a class= "btn btn-primary" type="button" th:href="@{/faq/list}">전체</a>
		 <span  th:each="category : ${faqCategoryList}">
			
			 <a class="btn btn-primary" type="button" th:href="@{|/faq/list/${category.no}|}" th:text="${category.category}"></a>
		</span>
		<a th:href="@{/faq/category}" sec:authorize="hasRole('ROLE_ADMIN')">카테고리목록</a>
		</div>
		
		
		
		
		<!--FAQ 목록-->
	<table class="table table-hover">
		<thead class="table table-primary">
		    <tr>
		      <th scope="col">번호</th>
			  <th scope="col">카테고리</th>
		      <th scope="col">글제목</th>
		      <th scope="col">작성자</th>
		      <th scope="col">작성일</th>
		    </tr>
		</thead>
		<tbody>
			<tr class="table" th:each="faq , loop : ${paging}" >
			      
<!--번호-->		<td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"> </td>	    
<!--카테고리-->	<td th:text="${faq.faqCategory.category}"> </td>
<!--글제목-->		<td><a class="s" th:href="@{|/faq/detail/${faq.no} |}" th:text="${faq.subject}"></a> </td>
<!--작성자-->	    <td th:text="${faq.author.membernick}"></td>
<!--작성일-->	    <td th:text="${#temporals.format(faq.createDate, 'yyyy-MM-dd HH:mm')}"></td>
			</tr>
		</tbody>
	</table>
		
	<!--질문등록 버튼-->
			<div class="row my-3">
			    <div class="col-6">
			        <a th:href="@{/faq/posting}" class="btn btn-primary" sec:authorize="hasRole('ROLE_ADMIN')">질문 등록하기</a>
				</div> 
			</div>

	
	
	
	<!--페이징-->
	<div th:if="${!paging.isEmpty()}">
	  <ul class="pagination justify-content-center">
	    <li class="page-item" th:classappend="${!paging.hasPrevious}? 'disabled'">
	      <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}">&laquo;</a>
	    </li>
		
	    <li th:each="page : ${#numbers.sequence(0, paging.totalPages -1)}" 
			th:if="${page-3 <paging.number and page+3 > paging.number}"
			th:classappend="${page == paging.number}? 'active'"	
			class="page-item ">
	      <a class="page-link" href="javascript:void(0)" th:data-page="${page}" th:text="${page+1}"></a>
	    </li>
	    <li class="page-item" th:classappend="${!paging.hasPrevious}? ' disabled'">
	      <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}">&raquo;</a>
	    </li>
	  </ul>
	</div>
	
	
	<!--검색-->
			<div class="col-6">
			       <div class="input-group">
			           <input type="text" id="search_kw" class="form-control" th:value="${kw}">
			           <button class="btn btn-outline-secondary" type="button" id="btn_search">찾기</button>
			      </div>
			</div>
				<form th:action="@{/faq/list}" method="get" id="searchForm">
				     <input type="hidden" id="kw" name="kw" th:value="${kw}">
				     <input type="hidden" id="page" name="page" th:value="${paging.number}">
				 </form>
	
				

	 </div>
	
</div>

<script layout:fragment="script" type='text/javascript'>
const page_elements = document.getElementsByClassName("page-link");
Array.from(page_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        document.getElementById('page').value = this.dataset.page;
        document.getElementById('searchForm').submit();
    });
});
const btn_search = document.getElementById("btn_search");
btn_search.addEventListener('click', function() {
    document.getElementById('kw').value = document.getElementById('search_kw').value;
    document.getElementById('page').value = 0;  // 검색버튼을 클릭할 경우 0페이지부터 조회한다.
    document.getElementById('searchForm').submit();
});
</script>



</body>
</html>