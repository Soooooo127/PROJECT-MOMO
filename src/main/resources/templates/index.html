<!DOCTYPE html>
<html layout:decorate="~{layout}">
	<head>
		<link rel="stylesheet" type="text/css" th:href="@{/css/index.css}">
		
		<title>모두 모이자, 모모!!!</title>
		
	</head>
	<body>
		<div layout:fragment="content" class="container">
					
			<div class="header" role="banner" >
			
			
				<!--검색-->
				<div class="search ">
						<div class="input-group" >
						<input type="text" id="search_kw" class="form-control" th:value="${kw}" placeholder="음식이나 식당을 검색해보세요">
						<button class="btn btn-outline-secondary" type="button" id="btn_search">찾기</button>
						</div>
				</div>
						<form th:action="@{/rest/list/search}" method="get" id="searchForm">
						<input type="hidden" id="kw" name="kw" th:value="${kw}">	   
						</form>	
				
			</div>
								
			

					<!--룰렛-->
						
					<div class="r">
					  <canvas width="380" height='380'></canvas>  
					  <button class="r_b" onclick="rotate()">룰렛 돌리기</button>
					</div>
					
					

								<!--슬라이드로 넘ㄱㅣㅅ기
								<div id="carouselExampleIndicators" class="carousel slide">
								  <div class="carousel-indicators">
								    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
								    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
								    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
								  </div>
								  <div class="carousel-inner">
								    <div class="carousel-item active">
								      <img src="" 
									  class="d-block w-100" alt="...">
								    </div>
								    <div class="carousel-item">
								      <img src="" class="d-block w-100" alt="...">
								    </div>
								    <div class="carousel-item">
								      <img src="" 
									  class="d-block w-100" alt="...">
								    </div>
								  </div>
								  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
								    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
								    <span class="visually-hidden">Previous</span>
								  </button>
								  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
								    <span class="carousel-control-next-icon" aria-hidden="true"></span>
								    <span class="visually-hidden">Next</span>
								  </button>
								</div>
								-->
					
					</div>
					
				</div>
				<!--검색 js-->
						<script layout:fragment="script" type='text/javascript'>

						const btn_search = document.getElementById("btn_search");
						btn_search.addEventListener('click', function() {
						    document.getElementById('kw').value = document.getElementById('search_kw').value;
						  
						    document.getElementById('searchForm').submit();
						});


						
						const $c = document.querySelector("canvas");
						const ctx = $c.getContext(`2d`);


						const product = [
						  "떡볶이", '돈가스', "초밥", "피자", "냉면", "치킨", '족발', "피자", "삼겹살",
						];

						const colors = ["#dc0936", "#e6471d", "#f7a416", "#efe61f ", "#60b236", "#209b6c", "#169ed8", "#3f297e", "#87207b", "#be107f", "#e7167b"];

						const newMake = () => {
						    const [cw, ch] = [$c.width / 2, $c.height / 2];
						    const arc = Math.PI / (product.length / 2);
						  
						    for (let i = 0; i < product.length; i++) {
						      ctx.beginPath();
						      ctx.fillStyle = colors[i % (colors.length -1)];
						      ctx.moveTo(cw, ch);
						      ctx.arc(cw, ch, cw, arc * (i - 1), arc * i);
						      ctx.fill();
						      ctx.closePath();
						    }

						    ctx.fillStyle = "#fff";
						    ctx.font = "18px Pretendard";
						    ctx.textAlign = "center";

						    for (let i = 0; i < product.length; i++) {
						      const angle = (arc * i) + (arc / 2);

						      ctx.save()  ;

						      ctx.translate(
						        cw + Math.cos(angle) * (cw - 50),
						        ch + Math.sin(angle) * (ch - 50),
						      );

						      ctx.rotate(angle + Math.PI / 2);

						      product[i].split(" ").forEach((text, j) => {
						        ctx.fillText(text, 0, 30 * j);
						      });

						      ctx.restore();
						    }
						}

						const rotate = () => {
						  $c.style.transform = `initial`;
						  $c.style.transition = `initial`;
						  
						  setTimeout(() => {
						    
						    const ran = Math.floor(Math.random() * product.length);

						    const arc = 360 / product.length;
						    const rotate = (ran * arc) + 3600 + (arc * 3) - (arc/4);
						    
						    $c.style.transform = `rotate(-${rotate}deg)`;
						    $c.style.transition = `2s`;
						    
						    setTimeout(() => alert(`오늘의 야식은?! ${product[ran]} 어떠신가요?`), 2000);
						  }, 1);
						};

						newMake();
						
						</script>
			</body>
		</html>

